    @Test
    public void testExistingDirectoryWithViolations() throws Exception {

        // we just reference there all violations
        final String[][] outputValues = {
            {"JavaNCSSCheckTestInput", "1", "84"},
        };

        exit.checkAssertionAfterwards(new Assertion() {
            @Override public void checkAssertion() throws IOException {
                String currentPath = new File(".").getCanonicalPath();
                String expectedPath = currentPath
                        + "/src/test/resources/com/puppycrawl/tools/checkstyle/metrics/"
                        .replace("/", File.separator);
                StringBuilder sb = new StringBuilder();
                sb.append("Starting audit...").append(System.getProperty("line.separator"));
                String format = "%s.java:%s: warning: File length is %s lines (max allowed is 80).";
                for (String[] outputValue : outputValues) {
                    String line = String.format(Locale.ROOT, format,
                            expectedPath + outputValue[0], outputValue[1],
                            outputValue[2]);
                    sb.append(line).append(System.getProperty("line.separator"));
                }
                sb.append("Audit done.").append(System.getProperty("line.separator"));
                assertEquals(sb.toString(), systemOut.getLog());
                assertEquals("", systemErr.getLog());
            }
        });

        Main.main("-c", "src/test/resources/com/puppycrawl/tools/checkstyle/config-filelength.xml",
            "src/test/resources/com/puppycrawl/tools/checkstyle/metrics/");
    }

