    @Test
    public void testWrongSeparatorLength() throws Exception {
        final RandomAccessFile file = new RandomAccessFile(
                getPath("InputNewlineAtEndOfFileLf.java"), "r") {
            @Override
            public int read(byte[] bytes) {
                return 0;
            }
        };

        try {
            Whitebox.invokeMethod(new NewlineAtEndOfFileCheck(), "endsWithNewline", file);
            fail("Exception is expected");
        }
        catch (IOException ex) {
            if (System.getProperty("os.name").toLowerCase(ENGLISH).startsWith("windows")) {
                assertEquals("Error message is unexpected",
                        "Unable to read 2 bytes, got 0", ex.getMessage());
            }
            else {
                assertEquals("Error message is unexpected",
                        "Unable to read 1 bytes, got 0", ex.getMessage());
            }
        }
    }

