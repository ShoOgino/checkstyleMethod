    @Test
    public void testWrongSeparatorLength() throws Exception {
        final RandomAccessFile file = new RandomAccessFile(
                getPath("InputNewlineAtEndOfFileLf.java"), "r") {
            @Override
            public int read(byte[] bytes) {
                return 0;
            }
        };

        try {
            Whitebox.invokeMethod(new NewlineAtEndOfFileCheck(), "endsWithNewline", file);
            fail("Exception is expected");
        }
        catch (IOException ex) {
            assertEquals("Error message is unexpected",
                    "Unable to read 1 bytes, got 0", ex.getMessage());
        }
    }

