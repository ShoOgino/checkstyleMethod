    @Test
    public void testCacheHeaderFile() throws Exception {
        final DefaultConfiguration checkConfig = createCheckConfig(HeaderCheck.class);
        checkConfig.addAttribute("headerFile", getConfigPath("java.header"));

        final DefaultConfiguration checkerConfig = new DefaultConfiguration("checkstyle_checks");
        checkerConfig.addChild(checkConfig);
        checkerConfig.addAttribute("cacheFile", temporaryFolder.newFile().getPath());

        final Checker checker = new Checker();
        final Locale locale = Locale.ROOT;
        checker.setLocaleCountry(locale.getCountry());
        checker.setLocaleLanguage(locale.getLanguage());
        checker.setModuleClassLoader(Thread.currentThread().getContextClassLoader());
        checker.configure(checkerConfig);
        checker.addListener(new BriefUtLogger(stream));

        final String[] expected = {
            "1: " + getCheckMessage(MSG_MISSING),
        };

        verify(checker, getPath("InputHeader.java"), expected);
        // One more time to use cache.
        verify(checker, getPath("InputHeader.java"), expected);

    }

