    @Test
    public void testProcessException() throws Exception {
        final ExceptionFileSetCheck check = new ExceptionFileSetCheck();
        check.configure(new DefaultConfiguration("filesetcheck"));
        check.setFileExtensions("tmp");
        final File firstFile = new File("inputAbstractFileSetCheck.tmp");

        final FileText fileText = new FileText(firstFile, Collections.emptyList());
        try {
            check.process(firstFile, fileText);
            fail("Exception is expected");
        }
        catch (IllegalArgumentException ex) {
            // exception is expected
            assertEquals("Test", ex.getMessage(), "Invalid exception message");
        }

        final SortedSet<LocalizedMessage> internalMessages =
                check.getMessages();
        assertEquals(1, internalMessages.size(), "Internal message should only have 1");

        // again to prove only 1 violation exists
        final File secondFile = new File("inputAbstractFileSetCheck.tmp");
        final FileText fileText2 = new FileText(secondFile, Collections.emptyList());
        try {
            check.process(secondFile, fileText2);
            fail("Exception is expected");
        }
        catch (IllegalArgumentException ex) {
            // exception is expected
            assertEquals("Test", ex.getMessage(), "Invalid exception message");
        }

        final SortedSet<LocalizedMessage> internalMessages2 =
            check.getMessages();
        assertEquals(1, internalMessages2.size(), "Internal message should only have 1 again");
    }

