    @Test
    public void testExistingTargetFileWithError()
            throws Exception {
        exit.expectSystemExitWithStatus(2);
        exit.checkAssertionAfterwards(() -> {
            final String expectedPath = getFilePath("InputMain.java");
            assertEquals(String.format(Locale.ROOT, "Starting audit...%n"
                    + "[ERROR] %1$s:3:14: "
                    + "Name 'InputMain' must match pattern '^[a-z0-9]*$'. [TypeName]%n"
                    + "[ERROR] %1$s:5:7: "
                    + "Name 'InputMainInner' must match pattern '^[a-z0-9]*$'. [TypeName]%n"
                    + "Audit done.%n"
                    + "Checkstyle ends with 2 errors.%n", expectedPath), systemOut.getLog());
            assertEquals("", systemErr.getLog());
        });
        Main.main("-c",
                getPath("config-classname2-error.xml"),
                getPath("InputMain.java"));
    }

