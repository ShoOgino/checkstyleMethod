    @Test
    public void testAuditFinishedWithoutFileFinished() throws IOException {
        final XMLLogger logger = new XMLLogger(outStream, true);
        logger.auditStarted(null);
        final AuditEvent fileStartedEvent = new AuditEvent(this, "Test.java");
        logger.fileStarted(fileStartedEvent);

        final LocalizedMessage message =
                new LocalizedMessage(1, 1,
                        "messages.properties", "key", null, SeverityLevel.ERROR, null,
                        getClass(), null);
        final AuditEvent errorEvent = new AuditEvent(this, "Test.java", message);
        logger.addError(errorEvent);

        logger.auditFinished(null);
        final String[] expectedLines = {
            "<file name=\"Test.java\">",
            "<error line=\"1\" column=\"1\" severity=\"error\" message=\"key\""
                    + " source=\"com.puppycrawl.tools.checkstyle.XMLLoggerTest\"/>",
            "</file>",
        };
        verifyLines(expectedLines);
    }

