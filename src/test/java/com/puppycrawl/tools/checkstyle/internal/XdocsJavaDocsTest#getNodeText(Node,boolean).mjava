    private static String getNodeText(Node node, boolean fixLinks) {
        final StringBuffer result = new StringBuffer(20);

        for (Node child = node.getFirstChild(); child != null; child = child.getNextSibling()) {
            if (child.getNodeType() == Node.TEXT_NODE) {
                for (String temp : child.getTextContent().split("\n")) {
                    final String text = temp.trim();

                    if (!text.isEmpty()) {
                        if (shouldAppendSpace(result)) {
                            result.append(' ');
                        }

                        result.append(text);
                    }
                }
            }
            else {
                appendNodeText(result, child, fixLinks);
            }
        }

        return result.toString();
    }

