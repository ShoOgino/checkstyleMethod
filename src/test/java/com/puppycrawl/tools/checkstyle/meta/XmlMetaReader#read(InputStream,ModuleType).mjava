    public static ModuleDetails read(InputStream moduleMetadataStream, ModuleType moduleType)
            throws ParserConfigurationException, IOException, SAXException {
        final DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        final Document document;
        final DocumentBuilder builder = factory.newDocumentBuilder();
        document = builder.parse(moduleMetadataStream);
        final Element root = document.getDocumentElement();
        final Element element = getDirectChildsByTag(root, "module").get(0);
        Element module = null;
        final ModuleDetails moduleDetails = new ModuleDetails();
        if (moduleType == ModuleType.CHECK) {
            module = getDirectChildsByTag(element, "check").get(0);
            moduleDetails.setModuleType(ModuleType.CHECK);
        }
        else if (moduleType == ModuleType.FILTER) {
            module = getDirectChildsByTag(element, "filter").get(0);
            moduleDetails.setModuleType(ModuleType.FILTER);
        }
        else if (moduleType == ModuleType.FILEFILTER) {
            module = getDirectChildsByTag(element, "file-filter").get(0);
            moduleDetails.setModuleType(ModuleType.FILEFILTER);
        }
        return createModule(module, moduleDetails);
    }

