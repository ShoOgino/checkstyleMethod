    /**
     * Returns {@link Configuration} instance for the given module name.
     * This implementation uses {@link AbstractModuleTestSupport#getConfiguration()} method inside.
     * @param moduleName module name.
     * @param moduleId module id.
     * @return {@link Configuration} instance for the given module name.
     * @throws CheckstyleException if exception occurs during configuration loading.
     */
    protected static Configuration getModuleConfig(String moduleName, String moduleId)
            throws CheckstyleException {
        final Configuration result;
        final List<Configuration> configs = getModuleConfigs(moduleName);
        if (configs.size() == 1) {
            result = configs.get(0);
        }
        else if (moduleId == null) {
            throw new IllegalStateException("multiple instances of the same Module are detected");
        }
        else {
            result = configs.stream().filter(conf -> {
                try {
                    return conf.getAttribute("id").equals(moduleId);
                }
                catch (CheckstyleException ex) {
                    throw new IllegalStateException("problem to get ID attribute from " + conf, ex);
                }
            })
            .findFirst().orElseGet(null);
        }

        return result;
    }

