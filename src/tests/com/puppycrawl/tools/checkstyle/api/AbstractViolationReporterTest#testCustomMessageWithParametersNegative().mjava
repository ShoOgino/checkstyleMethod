    @Test
    public void testCustomMessageWithParametersNegative() throws CheckstyleException
    {
        DefaultConfiguration config = createCheckConfig(emptyCheck.getClass());
        config.addMessage("msgKey", "This is a custom message {0.");
        emptyCheck.configure(config);

        LocalizedMessages collector = new LocalizedMessages();
        emptyCheck.setMessages(collector);

        emptyCheck.log(0, "msgKey", "TestParam");
        
        LocalizedMessage[] messages = collector.getMessages();
        Assert.assertTrue(messages.length == 1);
        
        //we expect an exception here because of the bogus custom message
        //format
        try {
            messages[0].getMessage();
            Assert.fail("Didn't receive expected exception.");
        }
        catch (IllegalArgumentException e) {
            //expected
        }
    }

