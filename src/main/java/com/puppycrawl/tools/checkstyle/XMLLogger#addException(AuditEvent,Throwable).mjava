    @Override
    public void addException(AuditEvent event, Throwable throwable) {
        final String fileName = event.getFileName();
        if (fileName == null) {
            synchronized (writerLock) {
                writeException(throwable);
            }
        }
        else {
            final FileMessages messages = fileMessages.computeIfAbsent(
                    fileName, name -> new FileMessages());
            messages.addException(throwable);
        }
    }

