    @Override
    public void visitToken(DetailAST ast) {
        final Details details = getDetails(ast);
        final DetailAST rcurly = details.rcurly;

        if (rcurly == null || rcurly.getType() != TokenTypes.RCURLY) {
            // we need to have both tokens to perform the check
            return;
        }

        final String violation;
        if (shouldStartLine) {
            final String targetSourceLine = getLines()[rcurly.getLineNo() - 1];
            violation = validate(details, getAbstractOption(), true, targetSourceLine);
        }
        else {
            violation = validate(details, getAbstractOption(), false, "");
        }

        if (!violation.isEmpty()) {
            log(rcurly, violation, "}", rcurly.getColumnNo() + 1);
        }
    }

